# coding: Shift_JIS
# 見取り図をカット

import os
import sys
import struct
from PIL import Image

# ---------------------------------------------------------------------------
def Cut1(p, sx, sy, scx, scy, ax, ay, acx, acy, dx, dy, fname):
  s = p.crop((sx, sy, sx+scx, sy+scy))
  a = p.crop((ax, ay, ax+acx, ay+acy))
  s.paste(a, (dx, dy))

  s.save(fname + ".png")
  s.close()

# ---------------------------------------------------------------------------
def Cut2(p, sx, sy, scx, scy, ax1, ay1, acx1, acy1, dx1, dy1, ax2, ay2, acx2, acy2, dx2, dy2, fname):
  s = p.crop((sx, sy, sx+scx, sy+scy))
  a1 = p.crop((ax1, ay1, ax1+acx1, ay1+acy1))
  a2 = p.crop((ax2, ay2, ax2+acx2, ay2+acy2))
  s.paste(a1, (dx1, dy1))
  s.paste(a2, (dx2, dy2))

  s.save(fname + ".png")
  s.close()

# ---------------------------------------------------------------------------
def Cut3(p, sx, sy, scx, scy, fname):
  s = p.crop((sx, sy, sx+scx, sy+scy))

  s.save(fname + ".png")
  s.close()

# ---------------------------------------------------------------------------
file = sys.argv[1]
p = Image.open(file)
print ("png_map... " + file)

# 外

#  0 門
Cut1(p, 0, 272, 224, 128, 296, 320, 56, 32, 80, 88, "map00")
#  1 倉
Cut1(p, 0, 272, 224, 128, 296, 256, 40, 48, 16, 32, "map01")
#  2 屋　敷
Cut1(p, 0, 272, 224, 128, 296, 304, 32, 16, 96, 72, "map02")
#  3 裏　庭
Cut1(p, 0, 272, 224, 128, 232, 384, 72, 16, 72, 16, "map03")
#  4 井　戸
Cut1(p, 0, 272, 224, 128, 280, 352, 48, 32, 160, 16, "map04")
#  5 テラス
Cut1(p, 0, 272, 224, 128, 296, 208, 64, 48, 136, 72, "map05")

# 1F

#  6 客　間
Cut1(p, 0, 0, 224, 128, 232, 216, 60, 24, 16, 96, "map06")
#  7 美和子の部屋
Cut1(p, 0, 0, 224, 128, 264, 48, 64, 32, 16, 64, "map07")
#  8 女主人の部屋
Cut1(p, 0, 0, 224, 128, 264, 0, 64, 48, 16, 16, "map08")
#  9 摩耶の部屋
Cut1(p, 0, 0, 224, 128, 236, 320, 60, 24, 148, 96, "map09")
# 10 客　間
Cut1(p, 0, 0, 224, 128, 236, 288, 60, 32, 148, 64, "map10")
# 11 １Ｆバスルーム
Cut1(p, 0, 0, 224, 128, 296, 160, 80, 48, 144, 16, "map11")
# 12 玄関ホール
Cut1(p, 0, 0, 224, 128, 328, 40, 48, 32, 88, 88, "map12")
# 13 食　堂
Cut2(p, 0, 0, 224, 128, 328, 0, 48, 40, 88, 40, 328, 112, 24, 24, 112, 16, "map13")
# 14 地下室
Cut1(p, 0, 0, 224, 128, 352, 112, 8, 24, 72, 16, "map14")

# 2F

# 15 深紗緒の部屋
Cut1(p, 0, 136, 224, 128, 232, 216, 64, 24, 16, 96, "map15")
# 16 客　間
Cut1(p, 0, 136, 224, 128, 232, 184, 64, 32, 16, 64, "map16")
# 17 客　間
Cut1(p, 0, 136, 224, 128, 236, 160, 56, 24, 20, 40, "map17")
# 18 草山の部屋
Cut1(p, 0, 136, 224, 128, 232, 136, 64, 24, 16, 16, "map18")
# 19 自分の部屋
Cut1(p, 0, 136, 224, 128, 236, 320, 60, 24, 148, 96, "map19")
# 20 雪菜の部屋
Cut1(p, 0, 136, 224, 128, 236, 288, 56, 32, 148, 64, "map20")
# 21 客　間
Cut1(p, 0, 136, 224, 128, 236, 260, 60, 28, 148, 36, "map21")
# 22 ２Ｆバスルーム
Cut1(p, 0, 136, 224, 128, 236, 240, 56, 20, 148, 16, "map22")
# 23 １階への階段
Cut1(p, 0, 136, 224, 128, 328, 72, 48, 24, 88, 96, "map23")
# 24 書　斎
Cut1(p, 0, 136, 224, 128, 232, 344, 48, 40, 88, 40, "map24")
# 25 昇り階段
Cut1(p, 0, 136, 224, 128, 336, 256, 16, 32, 64, 8, "map25")

# ノーマーク

# 26 １Ｆ廊下
Cut3(p, 0, 0, 224, 128, "map26")
# 27 ２Ｆ廊下
Cut3(p, 0, 136, 224, 128, "map27")
# 28 外
Cut3(p, 0, 272, 224, 128, "map28")


# memo
# map06と28はGBAで未使用
